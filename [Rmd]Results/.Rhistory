)
ind_data_e2 = data.frame(
sub = rep(data$sub,2),
numOfSwitch = rep(data$responses,2),
data_y = c(data$dilation_time,data$constriction_time),
events = rep(c('dilation','constriction'),times=c(length(data$sub),length(data$sub))),
exp = 'Exp2'
)
numOfSub_e2 = length(unique(ind_data_e2$sub))
# ####### Figure 5A(raster) #####
ind_data_raster = rbind(ind_data_e1_raster,ind_data_e2_raster)
ind_data = rbind(ind_data_e1,ind_data_e2)
ind_data$numOfSwitch = g3[as.integer(ind_data$numOfSwitch)+1]
ind_data = ind_data[,c(1,2,4,5,3)]
ind_data$numOfSwitch = factor(ind_data$numOfSwitch,c('unswitch','switch'))
data_anovaPD = aggregate( data_y ~ sub*numOfSwitch*exp, data = ind_data[ind_data$events == 'dilation',], FUN = "mean")
data_anovaPC = aggregate( data_y ~ sub*numOfSwitch*exp, data = ind_data[ind_data$events == 'constriction',], FUN = "mean")
reject = NULL
for(iSub in unique(data_anovaPD$sub)){
if(dim(data_anovaPD[data_anovaPD$sub == iSub,])[1] != 4){
reject = rbind(reject,iSub)
}
}
for(iSub in reject){
data_anovaPD = data_anovaPD[data_anovaPD$sub != iSub,]
data_anovaPC = data_anovaPC[data_anovaPC$sub != iSub,]
}
anovakun(data_anovaPD,"sAB",long=T, peta=T)
anovakun(data_anovaPC,"sAB",long=T, peta=T)
# p = dispLineGraph(data_anovaPD,config,c("exp","numOfSwitch"))+
#   facet_grid(. ~ exp )
p = dispBoxGraph(data_anovaPD,config,c("numOfSwitch","exp"))+
facet_grid(. ~ exp )
p
View(data_anovaPD)
View(ind_data)
if(mmFlg){
data=fromJSON(file="../[Python]PreProcessing/Exp1/data/PDPCevents_before2s_mm.json")
}else if(auFlg){
data=fromJSON(file="../[Python]PreProcessing/Exp1/data/PDPCevents_before2s_au.json")
}else{
data=fromJSON(file="../[Python]PreProcessing/Exp1/data/PDPCevents_before2s.json")
}
dat <- list(matrix(unlist(data$constriction),nrow=length(data$constriction),byrow=T),
matrix(unlist(data$dilation),nrow=length(data$dilation),byrow=T))
indices = NULL
events = NULL
sub = NULL
numOfSwitch = NULL
numOfTrial = NULL
for(i in 1:length(data$event)){
indices = rbind(indices, matrix(data[["indices"]][[i]])-4000 )
events = rbind(events, matrix(data[["event"]][[i]]))
sub = rbind(sub,matrix(rep(data$sub[i],length(data[["indices"]][[i]]))))
numOfSwitch = rbind(numOfSwitch,matrix(rep(data$numOfSwitch[i],length(data[["indices"]][[i]]))))
baseline = rbind(baseline,matrix(rep(data$baseline[i],length(data[["indices"]][[i]]))))
numOfTrial = rbind(numOfTrial,matrix(rep(data$numOfTrial[i],length(data[["indices"]][[i]]))))
}
for(i in 1:length(data$event)){
indices = rbind(indices, matrix(data[["indices"]][[i]])-4000 )
events = rbind(events, matrix(data[["event"]][[i]]))
sub = rbind(sub,matrix(rep(data$sub[i],length(data[["indices"]][[i]]))))
numOfSwitch = rbind(numOfSwitch,matrix(rep(data$numOfSwitch[i],length(data[["indices"]][[i]]))))
baseline = rbind(baseline,matrix(rep(data$Baseline[i],length(data[["indices"]][[i]]))))
numOfTrial = rbind(numOfTrial,matrix(rep(data$numOfTrial[i],length(data[["indices"]][[i]]))))
}
baseline = NULL
for(i in 1:length(data$event)){
indices = rbind(indices, matrix(data[["indices"]][[i]])-4000 )
events = rbind(events, matrix(data[["event"]][[i]]))
sub = rbind(sub,matrix(rep(data$sub[i],length(data[["indices"]][[i]]))))
numOfSwitch = rbind(numOfSwitch,matrix(rep(data$numOfSwitch[i],length(data[["indices"]][[i]]))))
baseline = rbind(baseline,matrix(rep(data$Baseline[i],length(data[["indices"]][[i]]))))
numOfTrial = rbind(numOfTrial,matrix(rep(data$numOfTrial[i],length(data[["indices"]][[i]]))))
}
baseline
ind_data_e1_raster = data.frame(
sub = sub,
numOfSwitch = numOfSwitch,
indices = indices,
events = g1[events+1],
numOfTrial = numOfTrial,
exp = 'Exp1'
)
# data$numOfTrial[i]
g1 = c('constriction','dilation')
g2 = c('0','1','2+')
# g2 = c('0','1')
g3 = c('unswitch','switch','switch')
ind_data_e1_raster = data.frame(
sub = sub,
numOfSwitch = numOfSwitch,
indices = indices,
events = g1[events+1],
numOfTrial = numOfTrial,
exp = 'Exp1'
)
indices = NULL
events = NULL
sub = NULL
numOfSwitch = NULL
numOfTrial = NULL
baseline = NULL
for(i in 1:length(data$event)){
indices = rbind(indices, matrix(data[["indices"]][[i]])-4000 )
events = rbind(events, matrix(data[["event"]][[i]]))
sub = rbind(sub,matrix(rep(data$sub[i],length(data[["indices"]][[i]]))))
numOfSwitch = rbind(numOfSwitch,matrix(rep(data$numOfSwitch[i],length(data[["indices"]][[i]]))))
baseline = rbind(baseline,matrix(rep(data$Baseline[i],length(data[["indices"]][[i]]))))
numOfTrial = rbind(numOfTrial,matrix(rep(data$numOfTrial[i],length(data[["indices"]][[i]]))))
}
# data$numOfTrial[i]
g1 = c('constriction','dilation')
g2 = c('0','1','2+')
# g2 = c('0','1')
g3 = c('unswitch','switch','switch')
ind_data_e1_raster = data.frame(
sub = sub,
numOfSwitch = numOfSwitch,
indices = indices,
events = g1[events+1],
numOfTrial = numOfTrial,
exp = 'Exp1'
)
ind_data_e1_raster[ind_data_e1_raster$numOfSwitch > length(g2)-2,]$numOfSwitch = length(g2)-1
ind_data_e1_raster$numOfSwitch = g2[ind_data_e1_raster$numOfSwitch+1]
ind_data_e1 = data.frame(
sub = rep(data$sub,2),
numOfSwitch = rep(data$numOfSwitch,2),
data_y = c(data$dilation_time,data$constriction_time),
events = rep(c('dilation','constriction'),times=c(length(data$sub),length(data$sub))),
baseline = baseline,
exp = 'Exp1'
)
ind_data_e1 = data.frame(
sub = rep(data$sub,2),
numOfSwitch = rep(data$numOfSwitch,2),
data_y = c(data$dilation_time,data$constriction_time),
events = rep(c('dilation','constriction'),times=c(length(data$sub),length(data$sub))),
baseline = data$sub,
exp = 'Exp1'
)
ind_data_e1 = data.frame(
sub = rep(data$sub,2),
numOfSwitch = rep(data$numOfSwitch,2),
data_y = c(data$dilation_time,data$constriction_time),
events = rep(c('dilation','constriction'),times=c(length(data$sub),length(data$sub))),
baseline = data$Baseline,
exp = 'Exp1'
)
View(ind_data_e1)
ind_data_e1[ind_data_e1$numOfSwitch > length(g2)-2,]$numOfSwitch = length(g2)-1
numOfSub_e1 = length(unique(ind_data_e1$sub))
if(mmFlg){
data=fromJSON(file="../[Python]PreProcessing/Exp2/data/PDPCevents_before2s_mm.json")
}else if(auFlg){
data=fromJSON(file="../[Python]PreProcessing/Exp2/data/PDPCevents_before2s_au.json")
}else{
data=fromJSON(file="../[Python]PreProcessing/Exp2/data/PDPCevents_before2s.json")
}
dat <- list(matrix(unlist(data$constriction),nrow=length(data$constriction),byrow=T),
matrix(unlist(data$dilation),nrow=length(data$dilation),byrow=T))
indices = NULL
events = NULL
sub = NULL
responses = NULL
numOfTrial = NULL
for(i in 1:length(data$event)){
if (length(data[["indices"]][[i]]) != 0){
indices = rbind(indices, matrix(data[["indices"]][[i]])-4000 )
events = rbind(events, matrix(data[["event"]][[i]]))
sub = rbind(sub,matrix(rep(data$sub[i],length(data[["indices"]][[i]]))))
responses = rbind(responses,matrix(rep(data$responses[i],length(data[["indices"]][[i]]))))
numOfTrial = rbind(numOfTrial,matrix(rep(data$numOfTrial[i],length(data[["indices"]][[i]]))))
}
}
ind_data_e2_raster = data.frame(
sub = sub,
numOfSwitch = responses,
indices = indices,
events = g1[events+1],
numOfTrial = numOfTrial,
exp = 'Exp2'
)
ind_data_e2 = data.frame(
sub = rep(data$sub,2),
numOfSwitch = rep(data$responses,2),
data_y = c(data$dilation_time,data$constriction_time),
events = rep(c('dilation','constriction'),times=c(length(data$sub),length(data$sub))),
baseline = data$Baseline,
exp = 'Exp2'
)
numOfSub_e2 = length(unique(ind_data_e2$sub))
ind_data = rbind(ind_data_e1,ind_data_e2)
ind_data$numOfSwitch = g3[as.integer(ind_data$numOfSwitch)+1]
ind_data = ind_data[,c(1,2,4,5,3)]
ind_data$numOfSwitch = factor(ind_data$numOfSwitch,c('unswitch','switch'))
View(forDrawingSigANOVA)
p = ggplot(ind_data,aes(x=Baseline,y=data_y))+
geom_point()
p
View(ind_data)
p = ggplot(ind_data,aes(x=baseline,y=data_y))+
geom_point()
p
p = ggplot(ind_data,aes(x=data_y,y=baseline))+
geom_point()
p
data_anovaPD = aggregate( data_y ~ sub*numOfSwitch*exp, data = ind_data[ind_data$events == 'dilation',], FUN = "mean")
data_anovaPD = aggregate( . ~ sub*numOfSwitch*exp, data = ind_data[ind_data$events == 'dilation',], FUN = "mean")
View(ind_data)
View(ind_data_e1)
View(ind_data_e2)
ind_data = rbind(ind_data_e1,ind_data_e2)
View(ind_data_e1)
ind_data$numOfSwitch = g3[as.integer(ind_data$numOfSwitch)+1]
ind_data = ind_data[,c(1,2,4,5,3)]
ind_data$numOfSwitch = factor(ind_data$numOfSwitch,c('unswitch','switch'))
data_anovaPD = aggregate( . ~ sub*numOfSwitch*exp, data = ind_data[ind_data$events == 'dilation',], FUN = "mean")
View(ind_data)
ind_data = rbind(ind_data_e1,ind_data_e2)
ind_data$numOfSwitch = g3[as.integer(ind_data$numOfSwitch)+1]
View(ind_data)
ind_data$numOfSwitch = factor(ind_data$numOfSwitch,c('unswitch','switch'))
data_anovaPD = aggregate( . ~ sub*numOfSwitch*exp, data = ind_data[ind_data$events == 'dilation',], FUN = "mean")
data_anovaPC = aggregate( . ~ sub*numOfSwitch*exp, data = ind_data[ind_data$events == 'constriction',], FUN = "mean")
View(data_anovaPD)
ind_data = rbind(ind_data_e1,ind_data_e2)
ind_data$numOfSwitch = g3[as.integer(ind_data$numOfSwitch)+1]
# ind_data = ind_data[,c(1,2,4,5,3)]
ind_data$numOfSwitch = factor(ind_data$numOfSwitch,c('unswitch','switch'))
View(ind_data)
t = ind_data[ind_data$events == 'dilation',]
t$events = NULL
data_anovaPD = aggregate( . ~ sub*numOfSwitch*exp, data = t, FUN = "mean")
View(data_anovaPD)
p = ggplot(data_anovaPD,aes(x = data_y,y = baseline))+
geom_point()
p
p = dispBoxGraph(data_anovaPD,config,c("numOfSwitch","exp"))+
facet_grid(. ~ exp )
p
if(mmFlg){
data=fromJSON(file="../[Python]PreProcessing/Exp2/data/PDPCevents_mm.json")
}else if(auFlg){
data=fromJSON(file="../[Python]PreProcessing/Exp2/data/PDPCevents_au.json")
}else{
data=fromJSON(file="../[Python]PreProcessing/Exp2/data/PDPCevents.json")
}
g2 = c('unswitch','switch')
countFigNum = 1
#### data loading ------------------------------------------------------------
if(mmFlg){
data=fromJSON(file="../[Python]PreProcessing/Exp1/data/PDPCevents_mm.json")
}else if(auFlg){
data=fromJSON(file="../[Python]PreProcessing/Exp1/data/PDPCevents_au.json")
}else{
data=fromJSON(file="../[Python]PreProcessing/Exp1/data/PDPCevents.json")
}
# if(mmFlg){
#   data=fromJSON(file="../[Python]PreProcessing/Exp1/data/PDPCevents_before2s_mm.json")
# }else if(auFlg){
#   data=fromJSON(file="../[Python]PreProcessing/Exp1/data/PDPCevents_before2s_au.json")
# }else{
#   data=fromJSON(file="../[Python]PreProcessing/Exp1/data/PDPCevents_before2s.json")
# }
dat <- list(matrix(unlist(data$constriction),nrow=length(data$constriction),byrow=T),
matrix(unlist(data$dilation),nrow=length(data$dilation),byrow=T))
indices = NULL
events = NULL
sub = NULL
numOfSwitch = NULL
numOfTrial = NULL
baseline = NULL
for(i in 1:length(data$event)){
indices = rbind(indices, matrix(data[["indices"]][[i]])-4000 )
events = rbind(events, matrix(data[["event"]][[i]]))
sub = rbind(sub,matrix(rep(data$sub[i],length(data[["indices"]][[i]]))))
numOfSwitch = rbind(numOfSwitch,matrix(rep(data$numOfSwitch[i],length(data[["indices"]][[i]]))))
baseline = rbind(baseline,matrix(rep(data$Baseline[i],length(data[["indices"]][[i]]))))
numOfTrial = rbind(numOfTrial,matrix(rep(data$numOfTrial[i],length(data[["indices"]][[i]]))))
}
# data$numOfTrial[i]
g1 = c('constriction','dilation')
g2 = c('0','1','2+')
# g2 = c('0','1')
g3 = c('unswitch','switch','switch')
ind_data_e1_raster = data.frame(
sub = sub,
numOfSwitch = numOfSwitch,
indices = indices,
events = g1[events+1],
numOfTrial = numOfTrial,
exp = 'Exp1'
)
ind_data_e1_raster[ind_data_e1_raster$numOfSwitch > length(g2)-2,]$numOfSwitch = length(g2)-1
ind_data_e1_raster$numOfSwitch = g2[ind_data_e1_raster$numOfSwitch+1]
ind_data_e1 = data.frame(
sub = rep(data$sub,2),
numOfSwitch = rep(data$numOfSwitch,2),
data_y = c(data$dilation_time,data$constriction_time),
events = rep(c('dilation','constriction'),times=c(length(data$sub),length(data$sub))),
baseline = data$Baseline,
exp = 'Exp1'
)
ind_data_e1[ind_data_e1$numOfSwitch > length(g2)-2,]$numOfSwitch = length(g2)-1
numOfSub_e1 = length(unique(ind_data_e1$sub))
#### Exp2
if(mmFlg){
data=fromJSON(file="../[Python]PreProcessing/Exp2/data/PDPCevents_mm.json")
}else if(auFlg){
data=fromJSON(file="../[Python]PreProcessing/Exp2/data/PDPCevents_au.json")
}else{
data=fromJSON(file="../[Python]PreProcessing/Exp2/data/PDPCevents.json")
}
# if(mmFlg){
#   data=fromJSON(file="../[Python]PreProcessing/Exp2/data/PDPCevents_before2s_mm.json")
# }else if(auFlg){
#   data=fromJSON(file="../[Python]PreProcessing/Exp2/data/PDPCevents_before2s_au.json")
# }else{
#   data=fromJSON(file="../[Python]PreProcessing/Exp2/data/PDPCevents_before2s.json")
# }
dat <- list(matrix(unlist(data$constriction),nrow=length(data$constriction),byrow=T),
matrix(unlist(data$dilation),nrow=length(data$dilation),byrow=T))
indices = NULL
events = NULL
sub = NULL
responses = NULL
numOfTrial = NULL
for(i in 1:length(data$event)){
if (length(data[["indices"]][[i]]) != 0){
indices = rbind(indices, matrix(data[["indices"]][[i]])-4000 )
events = rbind(events, matrix(data[["event"]][[i]]))
sub = rbind(sub,matrix(rep(data$sub[i],length(data[["indices"]][[i]]))))
responses = rbind(responses,matrix(rep(data$responses[i],length(data[["indices"]][[i]]))))
numOfTrial = rbind(numOfTrial,matrix(rep(data$numOfTrial[i],length(data[["indices"]][[i]]))))
}
}
ind_data_e2_raster = data.frame(
sub = sub,
numOfSwitch = responses,
indices = indices,
events = g1[events+1],
numOfTrial = numOfTrial,
exp = 'Exp2'
)
ind_data_e2 = data.frame(
sub = rep(data$sub,2),
numOfSwitch = rep(data$responses,2),
data_y = c(data$dilation_time,data$constriction_time),
events = rep(c('dilation','constriction'),times=c(length(data$sub),length(data$sub))),
baseline = data$Baseline,
exp = 'Exp2'
)
numOfSub_e2 = length(unique(ind_data_e2$sub))
# ####### Figure 5A(raster) #####
ind_data_raster = rbind(ind_data_e1_raster,ind_data_e2_raster)
p = ggplot(ind_data_raster,aes(x = indices, y = numOfTrial,group=events,color=events))+
geom_point(shape=16,alpha=0.4,size=1)+
scale_color_manual(values = c('gray80','black'))+
facet_grid(numOfSwitch ~ exp )
config = list(alpha = 0.4,
stride = 0.1,
label_x = "",
label_y = "# of PD events",
title = "")
# config$ylim = round(seq(0,2000,500),2)
# config$ylim_stride = 100
# config$xlim = round(seq(-2000,4000,1000),2)
# config$xlim_stride = 100
#
# p = setEmptyStyle(p,config)
p = p +
scale_x_continuous(breaks=round(seq(-4000,4000,1000),2),labels=round(seq(-4,4,1),2))+
xlab('Time[sec]')+ ylab('# trial')+
coord_cartesian(xlim=c(-2100,4000),expand=FALSE)
eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1
# ## average -----------------------------------------------------------------
ind_data = rbind(ind_data_e1,ind_data_e2)
ind_data$numOfSwitch = g3[as.integer(ind_data$numOfSwitch)+1]
# ind_data = ind_data[,c(1,2,4,5,3)]
ind_data$numOfSwitch = factor(ind_data$numOfSwitch,c('unswitch','switch'))
# # config = list(alpha = 0.4,
# #               stride = 0.1,
# #               label_x = "",
# #               label_y = "# of pupil dailation events",
# #               title = "")
# #
# # p = dispLineGraph(data_ave,config,c("numOfSwitch"))
# # p = setEmptyStyle(p)
# # p = p +
# #   scale_y_continuous(breaks=round(seq(2.1,2.4,0.1),2))+
# #   # scale_x_continuous(breaks=round(seq(0.5,1),2))+
# #   ylab('Normalized frequency')+
# #   coord_cartesian(xlim=c(0.5,2.5),ylim=c(2.05,2.5),expand=FALSE)+
# #   annotate(x=1, xend=2, y=2.05, yend=2.05, colour="black", lwd=0.5, geom="segment")+
# #   annotate(x=0.5, xend=0.5, y=2.1, yend=2.4, colour="black", lwd=0.5, geom="segment")+
# #   theme(
# #     axis.ticks = element_line(colour = "black",size = 0.5)
# #   )
#
#
# ####### Figure 5B(average) #######
t = ind_data[ind_data$events == 'dilation',]
t$events = NULL
data_anovaPD = aggregate( . ~ sub*numOfSwitch*exp, data = t, FUN = "mean")
t = ind_data[ind_data$events == 'constriction',]
t$events = NULL
data_anovaPC = aggregate( . ~ sub*numOfSwitch*exp, data = t, FUN = "mean")
p = ggplot(data_anovaPD,aes(x = data_y,y = baseline))+
geom_point()
p
View(data_anovaPD)
p = ggplot(ind_data,aes(x = data_y,y = baseline))+
geom_point()
p
p = ggplot(ind_data,aes(x = data_y,y = baseline,group=sub))+
geom_point()
p
p = ggplot(ind_data,aes(x = data_y,y = baseline,group=sub))+
wrap_grid(sub~.)
p = ggplot(ind_data,aes(x = data_y,y = baseline,group=sub))+
wrap_grid(sub~.)+
geom_point()
p = ggplot(ind_data,aes(x = data_y,y = baseline,group=sub))+
facet_wrap(sub~.)+
geom_point()
p
t = aggregate( baseline ~ sub*data_y*exp, data = ind_data, FUN = "mean")
t = aggregate( baseline ~ sub*data_y*exp, data = ind_data, FUN = "mean")
View(t)
p = ggplot(t,aes(x = data_y,y = baseline,group=sub))+
facet_wrap(sub~.)+
geom_point()
p
p = ggplot(t,aes(x = data_y,y = baseline,color=sub))+
# facet_wrap(sub~.)+
geom_point()
p
t = aggregate( baseline ~ sub*data_y*exp, data =ind_data[ind_data$events == 'dilation',], FUN = "mean")
p = ggplot(t,aes(x = data_y,y = baseline,color=sub))+
facet_wrap(sub~.)+
geom_point()
p
View(t)
t = aggregate( baseline ~ sub*data_y, data =ind_data[ind_data$events == 'dilation',], FUN = "mean")
p = ggplot(t,aes(x = data_y,y = baseline,color=sub))+
facet_wrap(sub~.)+
geom_point()
p
t = aggregate( baseline ~ sub*data_y, data =ind_data[ind_data$events == 'dilation',], FUN = "mean")
p = ggplot(t,aes(x = data_y,y = baseline,color=sub))+
# facet_wrap(sub~.)+
geom_point()
p
t$numEvents = t$data_y
t$data_y = t$baseline
p = dispBoxGraph(t,config,c("numEvents"))
p
View(t)
t = aggregate( baseline ~ sub*data_y, data =ind_data[ind_data$events == 'dilation',], FUN = "mean")
t$numEvents = t$data_y
t$data_y = t$baseline
p = dispBoxGraph(t,config,c("numEvents"))
p
t$numEvents = facotr(t$numEvents,levels=unique(t$numEvents))
t$numEvents = factor(t$numEvents,levels=unique(t$numEvents))
p = dispBoxGraph(t,config,c("numEvents"))
p
t = ind_data[ind_data$events == 'dilation',]
t$events = NULL
data_anovaPD = aggregate( . ~ sub*numOfSwitch*exp, data = t, FUN = "mean")
t = ind_data[ind_data$events == 'constriction',]
t$events = NULL
data_anovaPC = aggregate( . ~ sub*numOfSwitch*exp, data = t, FUN = "mean")
reject = NULL
for(iSub in unique(data_anovaPD$sub)){
if(dim(data_anovaPD[data_anovaPD$sub == iSub,])[1] != 4){
reject = rbind(reject,iSub)
}
}
for(iSub in reject){
data_anovaPD = data_anovaPD[data_anovaPD$sub != iSub,]
data_anovaPC = data_anovaPC[data_anovaPC$sub != iSub,]
}
anovakun(data_anovaPD,"sAB",long=T, peta=T)
View(ind_data)
ind_data = ind_data[,c(1,2,4,6,5,3)]
View(ind_data)
data_anovaPD = aggregate( data_y ~ sub*numOfSwitch*exp, data = ind_data[ind_data$events == 'dilation',], FUN = "mean")
data_anovaPC = aggregate( data_y ~ sub*numOfSwitch*exp, data = ind_data[ind_data$events == 'constriction',], FUN = "mean")
View(data_anovaPD)
reject = NULL
for(iSub in unique(data_anovaPD$sub)){
if(dim(data_anovaPD[data_anovaPD$sub == iSub,])[1] != 4){
reject = rbind(reject,iSub)
}
}
for(iSub in reject){
data_anovaPD = data_anovaPD[data_anovaPD$sub != iSub,]
data_anovaPC = data_anovaPC[data_anovaPC$sub != iSub,]
}
anovakun(data_anovaPD,"sAB",long=T, peta=T)
anovakun(data_anovaPC,"sAB",long=T, peta=T)
# p = dispLineGraph(data_anovaPD,config,c("exp","numOfSwitch"))+
#   facet_grid(. ~ exp )
p = dispBoxGraph(data_anovaPD,config,c("numOfSwitch","exp"))+
facet_grid(. ~ exp )
p
anovakun(data_anovaPD,"sAB",long=T, peta=T,gg=T)
View(ind_data_e2)
